<?php
  if (!isset($this->label)) {
    throw new \Exception('label undefined for confirm-menu component.');
  }

  $toggleLabelEsc = $this->transEsc($this->label);
  $toggleClassAttr = trim('confirm__toggle ' . $this->escapeHtmlAttr(($this->toggleClassAttr ?? 'btn')));

  $actionType = $this->action->type ?? 'submit';

  $confirmLabelEsc = $this->transEsc($this->confirm ?? 'confirm_dialog_yes');
  $cancelLabelEsc = $this->transEsc($this->cancel ?? 'confirm_dialog_no');
?>

<div class="confirm-menu">
  <button class="<?=$toggleClassAttr ?>"><?=$toggleLabelEsc ?></button>

  <div class="confirm__options">
    <?php if ($this->description): ?>
      <p class="confirm__desc"><?=$this->transEsc($this->description) ?></p>
    <?php endif; ?>

    <ul role="menu" class="confirm__menu">
      <li role="none">
        <?php if ($actionType == 'link'): ?>
          <a role="menuitem" class="confirm__confirm" href="<?=$this->escapeHtmlAttr($this->action->value) ?>">
            <?=$this->icon('ui-success', 'confirm__icon') ?>
            <?=$confirmLabelEsc ?>
          </a>
        <?php else: ?>
          <button role="menuitem" type="submit" class="confirm__confirm">
            <?=$this->icon('ui-success', 'confirm__icon') ?>
            <?=$confirmLabelEsc ?>
          </button>
        <?php endif; ?>
      </li>

      <li role="none">
        <button type="button" role="menuitem" class="confirm__cancel">
          <?=$this->icon('ui-failure', 'confirm__icon') ?>
          <?=$cancelLabelEsc ?>
        </button>
      </li>
    </ul>
  </div>
</div>
