<?php
  $wrapperTag = $this->wrapperTag ?? 'div';
  $wrapperClass = ($this->wrapperClass ? $this->wrapperClass . ' ' : '') . 'dropdown'; // Bootstrap class

  $toggleTag = $this->toggleTag ?? 'button';
  $toggleAttrs = $this->toggleAttrs ?? [];

  $toggleAttrs['class'] = 'dropdown-toggle'; // Bootstrap class
  $toggleAttrs['data-toggle'] = 'dropdown'; // Bootstrap data-attr
  $toggleAttrs['href'] = $this->href ?? $toggleTag == 'button' ? null : '#';
?>

<?php ob_start(); ?>
  <ul class="dropdown-menu">
    <?php foreach ($this->menuItems as $current): ?>
      <li class="dropdown__item <?php if ($current['selected']): ?> active<?php endif ?>">
        <a class="dropdown__link" href="<?=$this->escapeHtmlAttr($current['url']) ?>" rel="nofollow">
          <?=$this->transEsc($current['label']) ?>
        </a>
      </li>
    <?php endforeach; ?>
  </ul>

  <?=$this->makeTag(
    $toggleTag,
    $this->transEsc($this->toggleLabel) . $this->icon('dropdown-caret'),
    $toggleAttrs,
    ['escapeContent' => false]
  ); ?>
<?php $menuContents = ob_get_contents(); ?>
<?php ob_end_clean(); ?>

<?=$this->makeTag($wrapperTag, $menuContents, $wrapperClass, ['escapeContent' => false]); ?>
