<?php $maxSubjectsLimit = $this->config()->subjectLimit(); ?>
<?php $c = 0; foreach ($data as $field): ?>
  <?php $c++; ?>
  <div class="subject-line<?=($c > $maxSubjectsLimit ? ' subject-hidden hidden' : '' )?>" property="keywords">
    <?php $subject = ''; ?>
    <?php if(count($field) == 1) $field = explode('--', $field[0]); ?>
    <?php $i = 0; foreach ($field as $subfield): ?>
      <?=($i++ == 0) ? '' : ' &gt; '?>
      <?php $subject = trim($subject . ' ' . $subfield); ?>
      <a title="<?=$this->escapeHtmlAttr($subject)?>" href="<?=$this->record($this->driver)->getLink('subject', $subject)?>" rel="nofollow"><?=trim($this->escapeHtml($subfield))?></a>
    <?php endforeach; ?>
  </div>
<?php endforeach; ?>
<?php if ($c > $maxSubjectsLimit): ?>
  <div id="more-subjects" class="subject-line">
    <a href="#" class="more-subjects">
      <?=$this->transEsc('more') ?> ...
    </a>
  </div>
  <div id="less-subjects" class="subject-line hidden">
    <a href="#" class="less-subjects">
      <?=$this->transEsc('less') ?> ...
    </a>
  </div>
<?php endif; ?>
